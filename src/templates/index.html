{% extends "layout.html" %} 

{% block title %}Bibtex-apuri{% endblock %} 

{% block body %}
<div class="main-page">
  <div class="citations glass-effect">
    <h2>Viitteet</h2>
    
    {% if citations %}
      {% for citation in citations %}
        <div class="citation-container">
          {% if is_bibtex %}
            <pre>{{ citation.bibtex() }}</pre>
          {% else %}
            {{ citation }}
          {% endif %}
          {% if not is_bibtex %}
            <form action="/delete" method="POST" onsubmit="return popup()">
              <input type="hidden" name="id" value="{{ citation.id }}">
              <input type="hidden" name="type" value="{{ citation.type_as_string }}">
              <button class="delete-button" type="submit">Poista</button>
            </form>
          {% endif %}
        </div>
      {% endfor %}
    {% else %}
      <p>Ei lisättyjä viitteitä</p>
    {% endif %}

  <form id="sort" action="/sort" method="POST" class="new-citation-container glass-effect">
    <div class="form-selector-container">
      <label for="sort_by">Järjestä viitteet:</label>
      <select name="sort_by" id="sort_by" required>
        <option selected="selected" disabled>Valitse järjestys</option>
        <option value="year">Vuosi</option>
        <option value="author">Kirjoittaja</option>
        <option value="title">Otsikko</option>
      </select>
      <button class="normal-button" type="submit">Järjestä</button>
    </div>
  </form>
    

    <script>
      function popup() {
        return confirm("Are you sure you want to delete the citation?");
      }
    </script>
  </div>

  <div class="toggle-bibtex">
    {% if is_bibtex %}
      <form action="/" method="GET">
        <button type="submit">Normaalit viitteet</button>
      </form>
    {% else %}
      <form action="/toggle-bibtex" method="GET">
        <button type="submit">BibTeX viitteet</button>
      </form>
    {% endif %}
  </div>

  <br>
  <a href="/new">Luo uusi viite</a>
</div>

{% endblock %}
